INFO:     Will watch for changes in these directories: ['/Users/lien2022air/Documents/local_code/PreDataLab']
INFO:     Uvicorn running on http://0.0.0.0:8410 (Press CTRL+C to quit)
INFO:     Started reloader process [54928] using StatReload

    ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
    ┃  预数据实验室 - 数据处理工具集        ┃
    ┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
    ┃  运行地址: http://0.0.0.0:8410  ┃
    ┃  调试模式: 开启                    ┃
    ┃  按 Ctrl+C 退出                        ┃
    ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
    
INFO:     Started server process [54930]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:65076 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:65076 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:65077 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'chunklab_helper.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [54930]
INFO:     Started server process [55005]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:app.chunklab.chunk_service:开始切块处理: document_id=9, strategy=word, size=20, overlap=5
INFO:     127.0.0.1:65282 - "POST /chunklab/documents/9/chunk HTTP/1.1" 200 OK
ERROR:app.chunklab.chunking.word_strategy:切块过程中发生错误: 不支持的文件类型: .txt。Word策略只支持.docx文件，请为.txt文件选择合适的策略，如'.txt'应选择'纯文本切块策略'
ERROR:app.chunklab.chunk_service:切块处理异常: 不支持的文件类型: .txt。Word策略只支持.docx文件，请为.txt文件选择合适的策略，如'.txt'应选择'纯文本切块策略'
ERROR:app.chunklab.chunk_service:Traceback (most recent call last):
  File "/Users/lien2022air/Documents/local_code/PreDataLab/app/chunklab/chunk_service.py", line 168, in _process_chunks
    chunk_results = strategy.process_document(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lien2022air/Documents/local_code/PreDataLab/app/chunklab/chunking/base.py", line 85, in process_document
    return self.chunk_with_meta(file_path, chunk_size, overlap)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lien2022air/Documents/local_code/PreDataLab/app/chunklab/chunking/word_strategy.py", line 34, in chunk_with_meta
    raise ValueError(f"不支持的文件类型: {file_ext}。Word策略只支持.docx文件，请为{file_ext}文件选择合适的策略，如'.txt'应选择'纯文本切块策略'")
ValueError: 不支持的文件类型: .txt。Word策略只支持.docx文件，请为.txt文件选择合适的策略，如'.txt'应选择'纯文本切块策略'

INFO:     127.0.0.1:65282 - "GET /chunklab/documents/9/chunk/status HTTP/1.1" 200 OK
INFO:app.chunklab.chunk_service:开始切块处理: document_id=9, strategy=text, size=20, overlap=5
INFO:     127.0.0.1:65298 - "POST /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:app.chunklab.chunk_service:切块处理时间: 0.00秒
INFO:app.chunklab.chunk_service:切块完成，共产生 296 个块
INFO:app.chunklab.chunk_service:文档 9 切块成功保存到数据库
INFO:     127.0.0.1:65298 - "GET /chunklab/documents/9/chunk/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:65298 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:65298 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:65298 - "GET /chunklab/index HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'chunklab_helper.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [55005]
INFO:     Started server process [55024]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:49153 - "GET /chunklab/documents/3/chunk HTTP/1.1" 200 OK
INFO:app.chunklab.chunk_service:开始切块处理: document_id=3, strategy=word, size=300, overlap=30
ERROR:app.chunklab.chunk_service:文件不存在: /Users/lien2022air/Documents/local_code/ChunkLab/data/uploads/20250329_221410_Q-44-216.1.0-05-2022 总承包项目施工管理程序.docx
INFO:     127.0.0.1:49153 - "POST /chunklab/documents/3/chunk HTTP/1.1" 400 Bad Request
WARNING:  StatReload detected changes in 'chunklab_helper.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [55024]
INFO:     Started server process [55197]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:49199 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:app.chunklab.document_service:已删除文档: ID 3, 文件名 Q-44-216.1.0-05-2022 总承包项目施工管理程序.docx
INFO:     127.0.0.1:49199 - "DELETE /chunklab/documents/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49199 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:49199 - "GET /chunklab/documents/2/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:49199 - "GET /chunklab/index HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'app/chunklab/routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [55197]
INFO:     Started server process [55545]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:49800 - "GET /chunklab/documents/9/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:49800 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:49800 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:49804 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:49894 - "GET /chunklab/documents/8/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:49932 - "GET /chunklab/documents/8/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:49932 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:     127.0.0.1:50214 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50214 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50214 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50214 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50214 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50214 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50214 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50214 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50216 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50216 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50216 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50216 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50216 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50390 - "GET /chunklab/documents/9/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:50390 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50390 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50390 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50391 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50391 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:50391 - "GET /chunklab/documents/9/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:50391 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50391 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50534 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50534 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50710 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50710 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'chunklab_helper.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [55545]
INFO:     Started server process [56159]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:50793 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50793 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50793 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50793 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50794 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50794 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50858 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50858 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50858 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50858 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50863 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50863 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50919 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:51125 - "GET /chunklab/documents/8/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:51131 - "GET /chunklab/documents/8/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:51142 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:51142 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:51142 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:51160 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:51160 - "GET /chunklab/documents/9/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54199 - "GET /chunklab/documents/9/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54199 - "GET /chunklab/documents/9/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54199 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54200 - "GET /chunklab/documents/8/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54502 - "GET /chunklab/documents/8/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54504 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:54504 - "GET /chunklab/documents/6/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54660 - "GET /chunklab/documents/6/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54661 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:54661 - "GET /chunklab/documents/8/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54678 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:54678 - "GET /chunklab/documents/9/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:54678 - "GET /chunklab/index HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'app/database.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [56159]
INFO:     Started server process [60776]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:55029 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:55952 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:55952 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:55954 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:55954 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:55954 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:55954 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:55954 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56294 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56294 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56294 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56296 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56296 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56382 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56603 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56604 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56626 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56655 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56677 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:56677 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:56677 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:56689 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:app.chunklab.document_service:文件上传成功: 20250326-excel识别测试-简单_20250330205843.xlsx, ID: 10
INFO:     127.0.0.1:56725 - "POST /chunklab/upload HTTP/1.1" 200 OK
INFO:     127.0.0.1:56725 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:56760 - "GET /chunklab/documents/10/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:56760 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:app.chunklab.chunk_service:开始切块处理: document_id=10, strategy=excel_dict, size=300, overlap=30
INFO:     127.0.0.1:56760 - "POST /chunklab/documents/10/chunk HTTP/1.1" 200 OK
INFO:app.chunklab.chunking.excel_dict_strategy:开始处理Excel文件: /Users/lien2022air/Documents/local_code/PreDataLab/data/uploads/20250326-excel识别测试-简单_20250330205843.xlsx
INFO:app.chunklab.chunking.excel_dict_strategy:Excel列名: ['序号', '工程或费用项目名称', '编  制  依  据  及  计  算  说  明', 'Unnamed: 3', '合  价', '费用编码']
INFO:app.chunklab.chunking.excel_dict_strategy:已成功处理Excel文件，共生成 53 个切片
INFO:app.chunklab.chunk_service:切块处理时间: 0.19秒
INFO:app.chunklab.chunk_service:切块完成，共产生 53 个块
INFO:app.chunklab.chunk_service:文档 10 切块成功保存到数据库
INFO:     127.0.0.1:56760 - "GET /chunklab/documents/10/chunk/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:56760 - "GET /chunklab/documents/10/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:56760 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:     127.0.0.1:56797 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:56797 - "GET /chunklab/documents/10/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:56797 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:app.chunklab.document_service:已删除文件: /Users/lien2022air/Documents/local_code/PreDataLab/data/uploads/20250326-excel识别测试-简单_20250330205843.xlsx
INFO:app.chunklab.document_service:已删除文档: ID 10, 文件名 20250326-excel识别测试-简单_20250330205843.xlsx
INFO:     127.0.0.1:56980 - "DELETE /chunklab/documents/10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56980 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:56197 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:56199 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:56199 - "GET /chunklab/documents/9/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:56199 - "GET /chunklab/strategies/for-filetype?file_ext=.txt HTTP/1.1" 200 OK
INFO:     127.0.0.1:57318 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:57318 - "GET /chunklab/documents/8/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:58120 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:app.chunklab.document_service:文件上传成功: 20250326-excel识别测试-中等.xlsx, ID: 10
INFO:     127.0.0.1:58122 - "POST /chunklab/upload HTTP/1.1" 200 OK
INFO:     127.0.0.1:58122 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:58122 - "GET /chunklab/documents/10/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:58122 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:app.chunklab.chunk_service:开始切块处理: document_id=10, strategy=excel_dict, size=300, overlap=30
INFO:     127.0.0.1:58122 - "POST /chunklab/documents/10/chunk HTTP/1.1" 200 OK
INFO:app.chunklab.chunking.excel_dict_strategy:开始处理Excel文件: /Users/lien2022air/Documents/local_code/PreDataLab/data/uploads/20250326-excel识别测试-中等.xlsx
INFO:app.chunklab.chunking.excel_dict_strategy:Excel列名: ['序', '工程或费用名称', '取费基数', '费率：', '基础工程', '杆塔工程', '接地工程', '架线工程', '附件工程', '辅助工程', '合        计', '各项占总计(%)', '单位投资   (元/km)']
INFO:app.chunklab.chunking.excel_dict_strategy:已成功处理Excel文件，共生成 41 个切片
INFO:app.chunklab.chunk_service:切块处理时间: 0.03秒
INFO:app.chunklab.chunk_service:切块完成，共产生 41 个块
INFO:app.chunklab.chunk_service:文档 10 切块成功保存到数据库
INFO:     127.0.0.1:58122 - "GET /chunklab/documents/10/chunk/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:58122 - "GET /chunklab/documents/10/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:58122 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:     127.0.0.1:58122 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:58906 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61405 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61405 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61405 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61405 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:61662 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61662 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61662 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61854 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61854 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:61854 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:62047 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:62048 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:62048 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:62048 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:62167 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:62713 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:62713 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:63909 - "GET / HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lien2022air/Documents/local_code/PreDataLab/app/main.py", line 42, in index
    return templates.TemplateResponse("index.html", {"request": request, "now": datetime.now})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/templating.py", line 113, in TemplateResponse
    return _TemplateResponse(
           ^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/templating.py", line 39, in __init__
    content = template.render(context)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "app/templates/index.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "app/templates/base.html", line 189, in template
    {% block extra_css %}{% endblock %}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.TemplateAssertionError: block 'extra_css' defined twice
INFO:     127.0.0.1:63911 - "GET /apple-touch-icon-precomposed.png HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:63911 - "GET /apple-touch-icon.png HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:63913 - "GET / HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lien2022air/Documents/local_code/PreDataLab/app/main.py", line 42, in index
    return templates.TemplateResponse("index.html", {"request": request, "now": datetime.now})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/templating.py", line 113, in TemplateResponse
    return _TemplateResponse(
           ^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/templating.py", line 39, in __init__
    content = template.render(context)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "app/templates/index.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "app/templates/base.html", line 189, in template
    {% block extra_css %}{% endblock %}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.TemplateAssertionError: block 'extra_css' defined twice
INFO:     127.0.0.1:63915 - "GET / HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lien2022air/Documents/local_code/PreDataLab/app/main.py", line 42, in index
    return templates.TemplateResponse("index.html", {"request": request, "now": datetime.now})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/templating.py", line 113, in TemplateResponse
    return _TemplateResponse(
           ^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/templating.py", line 39, in __init__
    content = template.render(context)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "app/templates/index.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "app/templates/base.html", line 189, in template
    {% block extra_css %}{% endblock %}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.TemplateAssertionError: block 'extra_css' defined twice
INFO:     127.0.0.1:64098 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64098 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64098 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64098 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64098 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64099 - "GET / HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lien2022air/Documents/local_code/PreDataLab/app/main.py", line 42, in index
    return templates.TemplateResponse("index.html", {"request": request, "now": datetime.now})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/templating.py", line 113, in TemplateResponse
    return _TemplateResponse(
           ^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/starlette/templating.py", line 39, in __init__
    content = template.render(context)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "app/templates/index.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "/opt/miniconda3/envs/chunklab/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "app/templates/base.html", line 189, in template
    {% block extra_css %}{% endblock %}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.TemplateAssertionError: block 'extra_css' defined twice
INFO:     127.0.0.1:64124 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:64243 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64243 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64243 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64432 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64433 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64433 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64433 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64567 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64899 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:64899 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:50718 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50722 - "GET /chunklab/documents/10/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50722 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:     127.0.0.1:50722 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "GET /chunklab/documents/8/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:50761 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50761 - "GET /chunklab/documents/10/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50761 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:     127.0.0.1:50965 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50965 - "GET /chunklab/documents/6/chunks HTTP/1.1" 200 OK
INFO:     127.0.0.1:50969 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:app.chunklab.document_service:文件上传成功: 20250326-excel识别测试-中等_20250331094351.xlsx, ID: 11
INFO:     127.0.0.1:50969 - "POST /chunklab/upload HTTP/1.1" 200 OK
INFO:     127.0.0.1:50969 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:50969 - "GET /chunklab/documents/11/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:50969 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:app.chunklab.chunk_service:开始切块处理: document_id=11, strategy=excel_dict, size=300, overlap=30
INFO:     127.0.0.1:51091 - "POST /chunklab/documents/11/chunk HTTP/1.1" 200 OK
INFO:app.chunklab.chunking.excel_dict_strategy:开始处理Excel文件: /Users/lien2022air/Documents/local_code/PreDataLab/data/uploads/20250326-excel识别测试-中等_20250331094351.xlsx
INFO:app.chunklab.chunking.excel_dict_strategy:Excel列名: ['序', '工程或费用名称', '取费基数', '费率：', '基础工程', '杆塔工程', '接地工程', '架线工程', '附件工程', '辅助工程', '合        计', '各项占总计(%)', '单位投资   (元/km)']
INFO:app.chunklab.chunking.excel_dict_strategy:已成功处理Excel文件，共生成 41 个切片
INFO:app.chunklab.chunk_service:切块处理时间: 0.03秒
INFO:app.chunklab.chunk_service:切块完成，共产生 41 个块
INFO:app.chunklab.chunk_service:文档 11 切块成功保存到数据库
INFO:     127.0.0.1:51091 - "GET /chunklab/documents/11/chunk/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:51091 - "GET /chunklab/documents/11/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:51091 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:app.chunklab.chunk_service:开始切块处理: document_id=11, strategy=excel_dict, size=300, overlap=30
INFO:     127.0.0.1:51154 - "POST /chunklab/documents/11/chunk HTTP/1.1" 200 OK
INFO:app.chunklab.chunking.excel_dict_strategy:开始处理Excel文件: /Users/lien2022air/Documents/local_code/PreDataLab/data/uploads/20250326-excel识别测试-中等_20250331094351.xlsx
INFO:app.chunklab.chunking.excel_dict_strategy:Excel列名: ['序', '工程或费用名称', '取费基数', '费率：', '基础工程', '杆塔工程', '接地工程', '架线工程', '附件工程', '辅助工程', '合        计', '各项占总计(%)', '单位投资   (元/km)']
INFO:app.chunklab.chunking.excel_dict_strategy:已成功处理Excel文件，共生成 41 个切片
INFO:app.chunklab.chunk_service:切块处理时间: 0.03秒
INFO:app.chunklab.chunk_service:切块完成，共产生 41 个块
INFO:app.chunklab.chunk_service:文档 11 切块成功保存到数据库
INFO:     127.0.0.1:51154 - "GET /chunklab/documents/11/chunk/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:51154 - "GET /chunklab/documents/11/chunk HTTP/1.1" 200 OK
INFO:     127.0.0.1:51154 - "GET /chunklab/strategies/for-filetype?file_ext=.xlsx HTTP/1.1" 200 OK
INFO:     127.0.0.1:51173 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:51191 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:51249 - "GET /chunklab/index HTTP/1.1" 200 OK
INFO:     127.0.0.1:51264 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:51264 - "GET /chunklab/index HTTP/1.1" 200 OK
